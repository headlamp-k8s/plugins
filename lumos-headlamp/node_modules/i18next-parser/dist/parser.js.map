{"version":3,"file":"parser.js","names":["path","EventEmitter","HandlebarsLexer","HTMLLexer","JavascriptLexer","JsxLexer","lexers","hbs","handlebars","htm","html","mjs","js","ts","jsx","tsx","vue","lexersMap","Parser","_EventEmitter","_this","options","arguments","length","undefined","_classCallCheck","_callSuper","_objectSpread","_inherits","_createClass","key","value","parse","content","filename","_this2","keys","extension","extname","substr","_iterator","_createForOfIteratorHelper","_step","s","n","done","lexerConfig","lexerName","lexerOptions","lexer","Lexer","emit","Error","concat","on","warning","extract","err","e","f","default"],"sources":["../src/parser.js"],"sourcesContent":["import path from 'path'\nimport EventEmitter from 'events'\nimport HandlebarsLexer from './lexers/handlebars-lexer.js'\nimport HTMLLexer from './lexers/html-lexer.js'\nimport JavascriptLexer from './lexers/javascript-lexer.js'\nimport JsxLexer from './lexers/jsx-lexer.js'\n\nconst lexers = {\n  hbs: ['HandlebarsLexer'],\n  handlebars: ['HandlebarsLexer'],\n\n  htm: ['HTMLLexer'],\n  html: ['HTMLLexer'],\n\n  mjs: ['JavascriptLexer'],\n  js: ['JavascriptLexer'],\n  ts: ['JavascriptLexer'],\n  jsx: ['JsxLexer'],\n  tsx: ['JsxLexer'],\n\n  vue: ['JavascriptLexer'],\n\n  default: ['JavascriptLexer'],\n}\n\nconst lexersMap = {\n  HandlebarsLexer,\n  HTMLLexer,\n  JavascriptLexer,\n  JsxLexer,\n}\n\nexport default class Parser extends EventEmitter {\n  constructor(options = {}) {\n    super(options)\n    this.options = options\n    this.lexers = { ...lexers, ...options.lexers }\n  }\n\n  parse(content, filename) {\n    let keys = []\n    const extension = path.extname(filename).substr(1)\n    const lexers = this.lexers[extension] || this.lexers.default\n\n    for (const lexerConfig of lexers) {\n      let lexerName\n      let lexerOptions\n\n      if (\n        typeof lexerConfig === 'string' ||\n        typeof lexerConfig === 'function'\n      ) {\n        lexerName = lexerConfig\n        lexerOptions = {}\n      } else {\n        lexerName = lexerConfig.lexer\n        lexerOptions = lexerConfig\n      }\n\n      let Lexer\n      if (typeof lexerName === 'function') {\n        Lexer = lexerName\n      } else {\n        if (!lexersMap[lexerName]) {\n          this.emit('error', new Error(`Lexer '${lexerName}' does not exist`))\n        }\n\n        Lexer = lexersMap[lexerName]\n      }\n\n      const lexer = new Lexer(lexerOptions)\n      lexer.on('warning', (warning) => this.emit('warning', warning))\n      keys = keys.concat(lexer.extract(content, filename))\n    }\n\n    return keys\n  }\n}\n"],"mappings":"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"}