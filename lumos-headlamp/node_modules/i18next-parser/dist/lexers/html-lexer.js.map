{"version":3,"file":"html-lexer.js","names":["BaseLexer","cheerio","HTMLLexer","_BaseLexer","_this","options","arguments","length","undefined","_classCallCheck","_callSuper","attr","optionAttr","_inherits","_createClass","key","value","extract","content","_this2","that","$","load","concat","each","index","node","$node","keys","attribs","split","JSON","parse","_iterator","_createForOfIteratorHelper","_step","s","n","done","replace","text","push","_objectSpread","err","e","f","default"],"sources":["../../src/lexers/html-lexer.js"],"sourcesContent":["import BaseLexer from './base-lexer.js'\nimport * as cheerio from 'cheerio'\n\nexport default class HTMLLexer extends BaseLexer {\n  constructor(options = {}) {\n    super(options)\n\n    this.attr = options.attr || 'data-i18n'\n    this.optionAttr = options.optionAttr || 'data-i18n-options'\n  }\n\n  extract(content) {\n    const that = this\n    const $ = cheerio.load(content)\n    $(`[${that.attr}]`).each((index, node) => {\n      const $node = cheerio.load(node)\n\n      // the attribute can hold multiple keys\n      const keys = node.attribs[that.attr].split(';')\n      let options = node.attribs[that.optionAttr]\n\n      if (options) {\n        try {\n          options = JSON.parse(options)\n        } finally {\n        }\n      }\n\n      for (let key of keys) {\n        // remove any leading [] in the key\n        key = key.replace(/^\\[[a-zA-Z0-9_-]*\\]/, '')\n\n        // if empty grab innerHTML from regex\n        key = key || $node.text()\n\n        if (key) {\n          this.keys.push({ ...options, key })\n        }\n      }\n    })\n\n    return this.keys\n  }\n}\n"],"mappings":"qgGAAA,OAAOA,SAAS,MAAM,iBAAiB;AACvC,OAAO,KAAKC,OAAO,MAAM,SAAS;;AAEbC,SAAS,0BAAAC,UAAA;EAC5B,SAAAD,UAAA,EAA0B,KAAAE,KAAA,KAAdC,OAAO,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,CAAC,CAAC,CAAAG,eAAA,OAAAP,SAAA;IACtBE,KAAA,GAAAM,UAAA,OAAAR,SAAA,GAAMG,OAAO;;IAEbD,KAAA,CAAKO,IAAI,GAAGN,OAAO,CAACM,IAAI,IAAI,WAAW;IACvCP,KAAA,CAAKQ,UAAU,GAAGP,OAAO,CAACO,UAAU,IAAI,mBAAmB,QAAAR,KAAA;EAC7D,CAACS,SAAA,CAAAX,SAAA,EAAAC,UAAA,SAAAW,YAAA,CAAAZ,SAAA,KAAAa,GAAA,aAAAC,KAAA;;IAED,SAAAC,OAAOA,CAACC,OAAO,EAAE,KAAAC,MAAA;MACf,IAAMC,IAAI,GAAG,IAAI;MACjB,IAAMC,CAAC,GAAGpB,OAAO,CAACqB,IAAI,CAACJ,OAAO,CAAC;MAC/BG,CAAC,KAAAE,MAAA,CAAKH,IAAI,CAACT,IAAI,MAAG,CAAC,CAACa,IAAI,CAAC,UAACC,KAAK,EAAEC,IAAI,EAAK;QACxC,IAAMC,KAAK,GAAG1B,OAAO,CAACqB,IAAI,CAACI,IAAI,CAAC;;QAEhC;QACA,IAAME,IAAI,GAAGF,IAAI,CAACG,OAAO,CAACT,IAAI,CAACT,IAAI,CAAC,CAACmB,KAAK,CAAC,GAAG,CAAC;QAC/C,IAAIzB,OAAO,GAAGqB,IAAI,CAACG,OAAO,CAACT,IAAI,CAACR,UAAU,CAAC;;QAE3C,IAAIP,OAAO,EAAE;UACX,IAAI;YACFA,OAAO,GAAG0B,IAAI,CAACC,KAAK,CAAC3B,OAAO,CAAC;UAC/B,CAAC,SAAS;UACV;QACF,CAAC,IAAA4B,SAAA,GAAAC,0BAAA;;YAEeN,IAAI,EAAAO,KAAA,MAApB,KAAAF,SAAA,CAAAG,CAAA,MAAAD,KAAA,GAAAF,SAAA,CAAAI,CAAA,IAAAC,IAAA,GAAsB,KAAbvB,GAAG,GAAAoB,KAAA,CAAAnB,KAAA;YACV;YACAD,GAAG,GAAGA,GAAG,CAACwB,OAAO,CAAC,qBAAqB,EAAE,EAAE,CAAC;;YAE5C;YACAxB,GAAG,GAAGA,GAAG,IAAIY,KAAK,CAACa,IAAI,CAAC,CAAC;;YAEzB,IAAIzB,GAAG,EAAE;cACPI,MAAI,CAACS,IAAI,CAACa,IAAI,CAAAC,aAAA,CAAAA,aAAA,KAAMrC,OAAO,SAAEU,GAAG,EAAHA,GAAG,GAAE,CAAC;YACrC;UACF,CAAC,SAAA4B,GAAA,GAAAV,SAAA,CAAAW,CAAA,CAAAD,GAAA,aAAAV,SAAA,CAAAY,CAAA;MACH,CAAC,CAAC;;MAEF,OAAO,IAAI,CAACjB,IAAI;IAClB,CAAC,OAvCoC5B,SAAS,WAA3BE,SAAS,IAAA4C,OAAA"}