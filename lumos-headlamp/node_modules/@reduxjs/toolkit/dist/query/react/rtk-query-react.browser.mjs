import{buildCreateApi as Ke,coreModule as Ve}from"@reduxjs/toolkit/query";import"@reduxjs/toolkit";import{batch as Ee,useDispatch as ke,useSelector as Me,useStore as Oe}from"react-redux";import{createSelector as Fe}from"reselect";function q(e){return e.replace(e[0],e[0].toUpperCase())}function se(e){return e.type==="query"}function ue(e){return e.type==="mutation"}function _(e){return e.type==="infinitequery"}function L(e,...Q){return Object.assign(e,...Q)}import{formatProdErrorMessage as xe}from"@reduxjs/toolkit";import{defaultSerializeQueryArgs as me,QueryStatus as Se,skipToken as N}from"@reduxjs/toolkit/query";import{useCallback as C,useDebugValue as te,useEffect as w,useLayoutEffect as Ae,useMemo as x,useRef as O,useState as oe}from"react";import{shallowEqual as ne}from"react-redux";var K=Symbol();import{useEffect as le,useRef as ge,useMemo as Te}from"react";function ee(e,Q,R,l){let P=Te(()=>({queryArgs:e,serialized:typeof e=="object"?Q({queryArgs:e,endpointDefinition:R,endpointName:l}):e}),[e,Q,R,l]),g=ge(P);return le(()=>{g.current.serialized!==P.serialized&&(g.current=P)},[P]),g.current.serialized===P.serialized?g.current.queryArgs:e}import{useEffect as Re,useRef as De}from"react";import{shallowEqual as ae}from"react-redux";function V(e){let Q=De(e);return Re(()=>{ae(Q.current,e)||(Q.current=e)},[e]),ae(Q.current,e)?Q.current:e}var Pe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Be=Pe(),he=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Ue=he(),Ie=()=>Be||Ue?Ae:w,be=Ie(),ye=e=>e.isUninitialized?{...e,isUninitialized:!1,isFetching:!0,isLoading:e.data===void 0,status:Se.pending}:e;function re(e,...Q){let R={};return Q.forEach(l=>{R[l]=e[l]}),R}var ie=["data","status","isLoading","isSuccess","isError","error"];function pe({api:e,moduleOptions:{batch:Q,hooks:{useDispatch:R,useSelector:l,useStore:P},unstable__sideEffectsInRender:g,createSelector:F},serializeQueryArgs:U,context:B}){let I=g?t=>t():w;return{buildQueryHooks:H,buildInfiniteQueryHooks:Z,buildMutationHook:Y,usePrefetch:G};function W(t,i,p){if(i?.endpointName&&t.isUninitialized){let{endpointName:a}=i,o=B.endpointDefinitions[a];p!==N&&U({queryArgs:i.originalArgs,endpointDefinition:o,endpointName:a})===U({queryArgs:p,endpointDefinition:o,endpointName:a})&&(i=void 0)}let s=t.isSuccess?t.data:i?.data;s===void 0&&(s=t.data);let u=s!==void 0,n=t.isLoading,r=(!i||i.isLoading||i.isUninitialized)&&!u&&n,y=t.isSuccess||u&&(n&&!i?.isError||t.isUninitialized);return{...t,data:s,currentData:t.data,isFetching:n,isLoading:r,isSuccess:y}}function $(t,i,p){if(i?.endpointName&&t.isUninitialized){let{endpointName:a}=i,o=B.endpointDefinitions[a];U({queryArgs:i.originalArgs,endpointDefinition:o,endpointName:a})===U({queryArgs:p,endpointDefinition:o,endpointName:a})&&(i=void 0)}let s=t.isSuccess?t.data:i?.data;s===void 0&&(s=t.data);let u=s!==void 0,n=t.isLoading,r=(!i||i.isLoading||i.isUninitialized)&&!u&&n,y=t.isSuccess||n&&u;return{...t,data:s,currentData:t.data,isFetching:n,isLoading:r,isSuccess:y}}function G(t,i){let p=R(),s=V(i);return C((u,n)=>p(e.util.prefetch(t,u,{...s,...n})),[t,p,s])}function D(t,i,{refetchOnReconnect:p,refetchOnFocus:s,refetchOnMountOrArgChange:u,skip:n=!1,pollingInterval:r=0,skipPollingIfUnfocused:y=!1,...a}={}){let{initiate:o}=e.endpoints[t],c=R(),m=O(void 0);if(!m.current){let M=c(e.internalActions.internal_getRTKQSubscriptions());m.current=M}let f=ee(n?N:i,me,B.endpointDefinitions[t],t),d=V({refetchOnReconnect:p,refetchOnFocus:s,pollingInterval:r,skipPollingIfUnfocused:y}),S=O(!1),h=a.initialPageParam,b=V(h),T=O(void 0),{queryCacheKey:k,requestId:z}=T.current||{},J=!1;k&&z&&(J=m.current.isRequestSubscribed(k,z));let X=!J&&S.current;return I(()=>{S.current=J}),I(()=>{X&&(T.current=void 0)},[X]),I(()=>{let M=T.current;if(typeof process<"u",f===N){M?.unsubscribe(),T.current=void 0;return}let de=T.current?.subscriptionOptions;if(!M||M.arg!==f){M?.unsubscribe();let Qe=c(o(f,{subscriptionOptions:d,forceRefetch:u,..._(B.endpointDefinitions[t])?{initialPageParam:b}:{}}));T.current=Qe}else d!==de&&M.updateSubscriptionOptions(d)},[c,o,u,f,d,X,b,t]),[T,c,o,d]}function v(t,i){return(s,{skip:u=!1,selectFromResult:n}={})=>{let{select:r}=e.endpoints[t],y=ee(u?N:s,U,B.endpointDefinitions[t],t),a=O(void 0),o=x(()=>F([r(y),(S,h)=>h,S=>y],i,{memoizeOptions:{resultEqualityCheck:ne}}),[r,y]),c=x(()=>n?F([o],n,{devModeChecks:{identityFunctionCheck:"never"}}):o,[o,n]),m=l(S=>c(S,a.current),ne),f=P(),d=o(f.getState(),a.current);return be(()=>{a.current=d},[d]),m}}function A(t){w(()=>()=>{t.current?.unsubscribe?.(),t.current=void 0},[t])}function E(t){if(!t.current)throw new Error(xe(38));return t.current.refetch()}function H(t){let i=(u,n={})=>{let[r]=D(t,u,n);return A(r),x(()=>({refetch:()=>E(r)}),[r])},p=({refetchOnReconnect:u,refetchOnFocus:n,pollingInterval:r=0,skipPollingIfUnfocused:y=!1}={})=>{let{initiate:a}=e.endpoints[t],o=R(),[c,m]=oe(K),f=O(void 0),d=V({refetchOnReconnect:u,refetchOnFocus:n,pollingInterval:r,skipPollingIfUnfocused:y});I(()=>{let T=f.current?.subscriptionOptions;d!==T&&f.current?.updateSubscriptionOptions(d)},[d]);let S=O(d);I(()=>{S.current=d},[d]);let h=C(function(T,k=!1){let z;return Q(()=>{f.current?.unsubscribe(),f.current=z=o(a(T,{subscriptionOptions:S.current,forceRefetch:!k})),m(T)}),z},[o,a]),b=C(()=>{f.current?.queryCacheKey&&o(e.internalActions.removeQueryResult({queryCacheKey:f.current?.queryCacheKey}))},[o]);return w(()=>()=>{f?.current?.unsubscribe()},[]),w(()=>{c!==K&&!f.current&&h(c,!0)},[c,h]),x(()=>[h,c,{reset:b}],[h,c,b])},s=v(t,W);return{useQueryState:s,useQuerySubscription:i,useLazyQuerySubscription:p,useLazyQuery(u){let[n,r,{reset:y}]=p(u),a=s(r,{...u,skip:r===K}),o=x(()=>({lastArg:r}),[r]);return x(()=>[n,{...a,reset:y},o],[n,a,y,o])},useQuery(u,n){let r=i(u,n),y=s(u,{selectFromResult:u===N||n?.skip?void 0:ye,...n}),a=re(y,...ie);return te(a),x(()=>({...y,...r}),[y,r])}}}function Z(t){let i=(s,u={})=>{let[n,r,y,a]=D(t,s,u),o=O(a);I(()=>{o.current=a},[a]);let c=C(function(m,f){let d;return Q(()=>{n.current?.unsubscribe(),n.current=d=r(y(m,{subscriptionOptions:o.current,direction:f}))}),d},[n,r,y]);return A(n),x(()=>({trigger:c,refetch:()=>E(n),fetchNextPage:()=>c(s,"forward"),fetchPreviousPage:()=>c(s,"backward")}),[n,c,s])},p=v(t,$);return{useInfiniteQueryState:p,useInfiniteQuerySubscription:i,useInfiniteQuery(s,u){let{refetch:n,fetchNextPage:r,fetchPreviousPage:y}=i(s,u),a=p(s,{selectFromResult:s===N||u?.skip?void 0:ye,...u}),o=re(a,...ie,"hasNextPage","hasPreviousPage");return te(o),x(()=>({...a,fetchNextPage:r,fetchPreviousPage:y,refetch:n}),[a,r,y,n])}}}function Y(t){return({selectFromResult:i,fixedCacheKey:p}={})=>{let{select:s,initiate:u}=e.endpoints[t],n=R(),[r,y]=oe();w(()=>()=>{r?.arg.fixedCacheKey||r?.reset()},[r]);let a=C(function(T){let k=n(u(T,{fixedCacheKey:p}));return y(k),k},[n,u,p]),{requestId:o}=r||{},c=x(()=>s({fixedCacheKey:p,requestId:r?.requestId}),[p,r,s]),m=x(()=>i?F([c],i):c,[i,c]),f=l(m,ne),d=p==null?r?.arg.originalArgs:void 0,S=C(()=>{Q(()=>{r&&y(void 0),p&&n(e.internalActions.removeMutationResult({requestId:o,fixedCacheKey:p}))})},[n,p,r,o]),h=re(f,...ie,"endpointName");te(h);let b=x(()=>({...f,originalArgs:d,reset:S}),[f,d,S]);return x(()=>[a,b],[a,b])}}}var fe=Symbol(),ce=({batch:e=Ee,hooks:Q={useDispatch:ke,useSelector:Me,useStore:Oe},createSelector:R=Fe,unstable__sideEffectsInRender:l=!1,...P}={})=>({name:fe,init(g,{serializeQueryArgs:F},U){let B=g,{buildQueryHooks:I,buildInfiniteQueryHooks:W,buildMutationHook:$,usePrefetch:G}=pe({api:g,moduleOptions:{batch:e,hooks:Q,unstable__sideEffectsInRender:l,createSelector:R},serializeQueryArgs:F,context:U});return L(B,{usePrefetch:G}),L(U,{batch:e}),{injectEndpoint(D,v){if(se(v)){let{useQuery:A,useLazyQuery:E,useLazyQuerySubscription:H,useQueryState:Z,useQuerySubscription:Y}=I(D);L(B.endpoints[D],{useQuery:A,useLazyQuery:E,useLazyQuerySubscription:H,useQueryState:Z,useQuerySubscription:Y}),g[`use${q(D)}Query`]=A,g[`useLazy${q(D)}Query`]=E}if(ue(v)){let A=$(D);L(B.endpoints[D],{useMutation:A}),g[`use${q(D)}Mutation`]=A}else if(_(v)){let{useInfiniteQuery:A,useInfiniteQuerySubscription:E,useInfiniteQueryState:H}=W(D);L(B.endpoints[D],{useInfiniteQuery:A,useInfiniteQuerySubscription:E,useInfiniteQueryState:H}),g[`use${q(D)}InfiniteQuery`]=A}}}}});export*from"@reduxjs/toolkit/query";import{configureStore as ve,formatProdErrorMessage as Le}from"@reduxjs/toolkit";import{useContext as Ne}from"react";import{useEffect as Ce}from"react";import*as j from"react";import{Provider as we,ReactReduxContext as He}from"react-redux";import{setupListeners as ze}from"@reduxjs/toolkit/query";function qe(e){let Q=e.context||He;if(Ne(Q))throw new Error(Le(35));let[l]=j.useState(()=>ve({reducer:{[e.api.reducerPath]:e.api.reducer},middleware:P=>P().concat(e.api.middleware)}));return Ce(()=>e.setupListeners===!1?void 0:ze(l.dispatch,e.setupListeners),[e.setupListeners,l.dispatch]),j.createElement(we,{store:l,context:Q},e.children)}var It=Ke(Ve(),ce());export{qe as ApiProvider,K as UNINITIALIZED_VALUE,It as createApi,ce as reactHooksModule,fe as reactHooksModuleName};
//# sourceMappingURL=rtk-query-react.browser.mjs.map