(function(e,d){typeof exports=="object"&&typeof module<"u"?d(require("react/jsx-runtime"),require("@kinvolk/headlamp-plugin/lib"),require("@mui/material"),require("@kinvolk/headlamp-plugin/lib/k8s/cluster")):typeof define=="function"&&define.amd?define(["react/jsx-runtime","@kinvolk/headlamp-plugin/lib","@mui/material","@kinvolk/headlamp-plugin/lib/k8s/cluster"],d):(e=typeof globalThis<"u"?globalThis:e||self,d(e.pluginLib.ReactJSX,e.pluginLib,e.pluginLib.MuiMaterial,e.pluginLib.K8s.cluster))})(this,(function(e,d,s,o){"use strict";const l=class l extends o.KubeObject{get usageParams(){var n;return((n=this.status)==null?void 0:n.flavorsUsage)||[]}};l.kind="ClusterQueue",l.apiName="clusterqueues",l.apiVersion="kueue.x-k8s.io/v1beta1",l.isNamespaced=!1;let p=l;const c=class c extends o.KubeObject{};c.kind="LocalQueue",c.apiName="localqueues",c.apiVersion="kueue.x-k8s.io/v1beta1",c.isNamespaced=!0;let u=c;const r=class r extends o.KubeObject{get isPending(){var t,a,T,g;if((a=(t=this.status)==null?void 0:t.conditions)==null?void 0:a.find(h=>h.type==="Finished"&&h.status==="True"))return!1;const i=(g=(T=this.status)==null?void 0:T.conditions)==null?void 0:g.find(h=>h.type==="Admitted");return!i||i.status==="False"}get pendingReason(){var i,t;const n=(t=(i=this.status)==null?void 0:i.conditions)==null?void 0:t.find(a=>a.type==="Admitted");return n&&n.status==="False"?`${n.reason}: ${n.message}`:"Waiting for Quota..."}};r.kind="Workload",r.apiName="workloads",r.apiVersion="kueue.x-k8s.io/v1beta1",r.isNamespaced=!0;let b=r;const f=()=>{const[k]=p.useList(),[n]=b.useList();return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(s.Typography,{variant:"h4",gutterBottom:!0,children:"Kueue Batch Observability"}),e.jsx(s.Typography,{variant:"h6",style:{marginTop:"20px"},children:"Cluster Queues"}),e.jsx(s.TableContainer,{component:s.Paper,children:e.jsxs(s.Table,{children:[e.jsx(s.TableHead,{children:e.jsxs(s.TableRow,{children:[e.jsx(s.TableCell,{children:"Name"}),e.jsx(s.TableCell,{children:"Namespace"}),e.jsx(s.TableCell,{children:"Pending Workloads"}),e.jsx(s.TableCell,{children:"Quota Usage"})]})}),e.jsx(s.TableBody,{children:(k||[]).map(i=>e.jsxs(s.TableRow,{children:[e.jsx(s.TableCell,{children:i.metadata.name}),e.jsx(s.TableCell,{children:i.metadata.namespace||"Cluster Scope"}),e.jsx(s.TableCell,{children:(n||[]).filter(t=>{var a;return((a=t.spec)==null?void 0:a.queueName)===i.metadata.name&&t.isPending}).length}),e.jsx(s.TableCell,{children:e.jsx(s.LinearProgress,{variant:"determinate",value:60,style:{width:"100px"}})})]},i.metadata.uid))})]})}),e.jsx(s.Typography,{variant:"h6",style:{marginTop:"30px",color:"#d32f2f"},children:"Pending Workloads (Needs Attention)"}),e.jsx(s.TableContainer,{component:s.Paper,children:e.jsxs(s.Table,{children:[e.jsx(s.TableHead,{children:e.jsxs(s.TableRow,{children:[e.jsx(s.TableCell,{children:"Job Name"}),e.jsx(s.TableCell,{children:"Reason"}),e.jsx(s.TableCell,{children:"Status"})]})}),e.jsx(s.TableBody,{children:(n||[]).filter(i=>i.isPending).map(i=>e.jsxs(s.TableRow,{children:[e.jsx(s.TableCell,{children:i.metadata.name}),e.jsx(s.TableCell,{style:{color:"red"},children:i.pendingReason}),e.jsx(s.TableCell,{children:e.jsx(s.Chip,{label:"Pending",color:"secondary",size:"small"})})]},i.metadata.uid))})]})})]})};d.registerSidebarEntry({parent:null,name:"kueue",label:"Kueue Batch",url:"/kueue",icon:"mdi:chart-bar-stacked"}),d.registerRoute({path:"/kueue",sidebar:"kueue",name:"Kueue",exact:!0,component:()=>e.jsx(f,{})})}));
